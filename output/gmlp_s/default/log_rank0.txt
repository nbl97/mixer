[2021-08-05 16:52:09 gmlp_s] (main.py 350): INFO Full config saved to output/gmlp_s/default/config.json
[2021-08-05 16:52:09 gmlp_s] (main.py 353): INFO AMP_OPT_LEVEL: O1
AUG:
  AUTO_AUGMENT: rand-m9-mstd0.5-inc1
  COLOR_JITTER: 0.4
  CUTMIX: 1.0
  CUTMIX_MINMAX: null
  MIXUP: 0.8
  MIXUP_MODE: batch
  MIXUP_PROB: 1.0
  MIXUP_SWITCH_PROB: 0.5
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.0
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: imagenet
  DATA_PATH: /home/bolin/data/tiny_imagenet/
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 8
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_MODE: false
FINETUNE: null
ITP: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.05
  DROP_RATE: 0.0
  GMLP:
    ATTENTION: false
  LABEL_SMOOTHING: 0.1
  MIXER:
    HIDDEN_DIM: 512
    IN_CHANS: 3
    MLP_RATIO:
    - 0.5
    - 4.0
    NUM_BLOCKS: 8
    PATCH_SIZE: 16
    STEM_NORM: false
  NAME: gmlp_s
  NUM_CLASSES: 1000
  RESUME: ''
  TYPE: gmlp
OUTPUT: output/gmlp_s/default
PRINT_FREQ: 10
SAVE_FREQ: 1
SEED: 0
TAG: default
TEST:
  CROP: true
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 0
  AUTO_RESUME: true
  BASE_LR: 0.001
  CLIP_GRAD: 1.0
  EPOCHS: 300
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-05
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    EPS: 1.0e-06
    MOMENTUM: 0.9
    NAME: adamw
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 32
  WARMUP_LR: 1.0e-06
  WEIGHT_DECAY: 0.05

[2021-08-05 16:52:19 gmlp_s] (main.py 82): INFO Creating model:gmlp/gmlp_s
[2021-08-05 16:52:19 gmlp_s] (main.py 85): INFO gmlp(
  (stem): PatchEmbed(
    (proj): Conv2d(3, 256, kernel_size=(16, 16), stride=(16, 16))
    (norm): Identity()
  )
  (blocks): Sequential(
    (0): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (1): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (2): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (3): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (4): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (5): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (6): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (7): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (8): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (9): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (10): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (11): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (12): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (13): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (14): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (15): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (16): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (17): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (18): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (19): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (20): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (21): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (22): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (23): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (24): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (25): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (26): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (27): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (28): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
    (29): SpatialGatingBlock(
      (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
      (mlp_channels): GatedMlp(
        (fc1): Linear(in_features=256, out_features=1536, bias=True)
        (act): GELU()
        (gate): SpatialGatingUnit(
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (proj): Linear(in_features=196, out_features=196, bias=True)
        )
        (fc2): Linear(in_features=768, out_features=256, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath()
    )
  )
  (norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  (head): Linear(in_features=256, out_features=1000, bias=True)
)
[2021-08-05 16:52:19 gmlp_s] (main.py 95): INFO number of params: 19422656
[2021-08-05 16:52:19 gmlp_s] (main.py 122): INFO no checkpoint found in output/gmlp_s/default, ignoring auto resume
[2021-08-05 16:52:19 gmlp_s] (main.py 138): INFO Start training
